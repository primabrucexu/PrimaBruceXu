# Cassandra

## 1. 简介

### 1.1 是什么

**关键词：**NoSQL、列式存储、分布式

Apache Cassandra是一个开源的、分布式的NoSQL数据库。它提出了一个最终具有一致语义的分区宽列存储模型。

Apache Cassandra最初是Facebook设计的，使用分阶段事件驱动架构(SEDA)
来实现Amazon的Dynamo分布式存储和复制技术和谷歌的Bigtable数据和存储引擎模型的结合。Dynamo和Bigtable都是为了满足可伸缩、可靠和高可用存储系统的新需求而开发的，但它们都有可以改进的地方。

Cassandra被设计为这两种系统的最佳组合，以满足新兴的大规模数据占用和查询量，存储需求。随着应用程序开始需要完全的全局复制和始终可用的低延迟读写，设计一种新的数据库模型变得势在必行，因为当时的关系数据库系统正在努力满足全局规模应用程序的新需求。

Cassandra在设计时遵循了以下原则

- 完全多主数据库复制
- 低延迟的全局可用性
- 在普通硬件上扩展
- 每增加一个额外处理节点，吞吐量线性增加
- 在线负载平衡和集群增长
- 分区key-oriented查询
- 灵活的模式

### 1.2 专业术语

- **cluster**，集群
- **commitlog**，提交日志，用于故障恢复
- **datacenter**，一组位于统一集群的节点
- **gossip**，一致性协议，类似于病毒传播，非拜占庭
- **hint**，一种数据恢复技术
- **listen address**，节点绑定的网络地址
- **seed node**，种子节点，用于引导当前节点加入集群
- **snitch**，从节点的 IP 地址到物理和虚拟位置(如机架和数据中心)的映射，不同的snitch会影响请求路由机制
- **SSTable**，一个k-v的持久的、有序的不可变映射

### 1.3 Cassandra的特性

Cassandra实现了CAP理论中的AP，对一致性有部分取舍。最终实现了以下功能

- 高可伸缩性


- 高可用

- 耐用性

- 最终一致性

- 线性化一致性的轻量级事务

- 批量写要么全部成功，要么全部失败

- 二级索引保证与其本地副本数据一致

## 2. CQL

